import{a as E}from"./chunk-BW7PFCKW.js";import{Ha as C,Ic as R,Oa as D,a as r,b as S,da as I,ia as x,ja as p,ob as w,pb as v,qc as y,rc as j,xc as A}from"./chunk-U7O5KEBD.js";var g=Symbol("STATE_SIGNAL");function l(n,...t){n[g].update(o=>t.reduce((e,s)=>r(r({},e),typeof s=="function"?s(e):s),o))}function M(n){let t=j(()=>n());return J(t)?new Proxy(n,{get(o,e){return e in t?(w(o[e])||Object.defineProperty(o,e,{value:y(()=>o()[e]),configurable:!0}),M(o[e])):o[e]}}):n}function J(n){return n?.constructor===Object}function N(...n){let t=[...n],o="providedIn"in t[0]?t.shift():{},e=t;return(()=>{class i{constructor(){let c=e.reduce((k,B)=>B(k),V()),{slices:a,signals:m,methods:f,hooks:u}=c,h=r(r(r({},a),m),f);this[g]=c[g];for(let k in h)this[k]=h[k];let{onInit:L,onDestroy:U}=u;L&&L(),U&&p(C).onDestroy(U)}static \u0275fac=function(a){return new(a||i)};static \u0275prov=I({token:i,factory:i.\u0275fac,providedIn:o.providedIn||null})}return i})()}function V(){return{[g]:v({}),slices:{},signals:{},methods:{},hooks:{}}}function b(n,t){return Object.keys(n).reduce((o,e)=>(t.includes(e)||(o[e]=n[e]),o),{})}function P(n){return t=>{let o=n(r(r({},t.slices),t.signals)),e=Object.keys(o),s=b(t.slices,e),i=b(t.methods,e);return S(r({},t),{slices:s,signals:r(r({},t.signals),o),methods:i})}}function $(n){return t=>{let o=n(r(r(r({[g]:t[g]},t.slices),t.signals),t.methods)),e=Object.keys(o),s=b(t.slices,e),i=b(t.signals,e);return S(r({},t),{slices:s,signals:i,methods:r(r({},t.methods),o)})}}function H(n){return t=>{let o=typeof n=="function"?n():n,e=Object.keys(o);t[g].update(c=>r(r({},c),o));let s=e.reduce((c,a)=>{let m=y(()=>t[g]()[a]);return S(r({},c),{[a]:M(m)})},{}),i=b(t.signals,e),d=b(t.methods,e);return S(r({},t),{slices:r(r({},t.slices),s),signals:i,methods:d})}}var K={production:!1,apiUrl:"http://127.0.0.1:3000/api"};var z=(()=>{let t=class t{constructor(){this.apiUrl=K.apiUrl,this.http=p(E)}login(e){return this.http.post(`${this.apiUrl}/users/login`,e)}register(e){return this.http.post(`${this.apiUrl}/users/signup`,e)}getCurrentUser(){return this.http.get(`${this.apiUrl}/users/current`)}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();var G=(()=>{let t=class t{constructor(e,s){this.document=e,this.platformId=s,this.documentIsAccessible=R(this.platformId)}static getCookieRegExp(e){let s=e.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+s+"|;\\s*"+s+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(e){try{return decodeURIComponent(e)}catch{return e}}check(e){return this.documentIsAccessible?(e=encodeURIComponent(e),t.getCookieRegExp(e).test(this.document.cookie)):!1}get(e){if(this.documentIsAccessible&&this.check(e)){e=encodeURIComponent(e);let i=t.getCookieRegExp(e).exec(this.document.cookie);return i[1]?t.safeDecodeURIComponent(i[1]):""}else return""}getAll(){if(!this.documentIsAccessible)return{};let e={},s=this.document;return s.cookie&&s.cookie!==""&&s.cookie.split(";").forEach(i=>{let[d,c]=i.split("=");e[t.safeDecodeURIComponent(d.replace(/^ /,""))]=t.safeDecodeURIComponent(c)}),e}set(e,s,i,d,c,a,m){if(!this.documentIsAccessible)return;if(typeof i=="number"||i instanceof Date||d||c||a||m){let h={expires:i,path:d,domain:c,secure:a,sameSite:m||"Lax"};this.set(e,s,h);return}let f=encodeURIComponent(e)+"="+encodeURIComponent(s)+";",u=i||{};if(u.expires)if(typeof u.expires=="number"){let h=new Date(new Date().getTime()+u.expires*1e3*60*60*24);f+="expires="+h.toUTCString()+";"}else f+="expires="+u.expires.toUTCString()+";";u.path&&(f+="path="+u.path+";"),u.domain&&(f+="domain="+u.domain+";"),u.secure===!1&&u.sameSite==="None"&&(u.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${e} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),u.secure&&(f+="secure;"),u.sameSite||(u.sameSite="Lax"),f+="sameSite="+u.sameSite+";",this.document.cookie=f}delete(e,s,i,d,c="Lax"){if(!this.documentIsAccessible)return;let a=new Date("Thu, 01 Jan 1970 00:00:01 GMT");this.set(e,"",{expires:a,path:s,domain:i,secure:d,sameSite:c})}deleteAll(e,s,i,d="Lax"){if(!this.documentIsAccessible)return;let c=this.getAll();for(let a in c)c.hasOwnProperty(a)&&this.delete(a,e,s,i,d)}};t.\u0275fac=function(s){return new(s||t)(x(A),x(D))},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();var q={isLoading:!1,isSubmitted:!1,isLoggedIn:!1,user:null,message:""},de=N({providedIn:"root"},H(q),P(n=>({})),$((n,t=p(z),o=p(G))=>({setCurrentUser:()=>{t.getCurrentUser().subscribe({next:e=>{l(n,{isLoggedIn:!0,user:e})},error:e=>{l(n,{isLoggedIn:!1,user:null,message:e.message||"User is not authorized"})}})},logout:()=>{o.delete("token","/"),l(n,{isLoading:!1,isSubmitted:!1,isLoggedIn:!1,user:null,message:"User is logged out"})},reset:()=>{l(n,{isLoading:!1,isSubmitted:!1,isLoggedIn:!1,user:null,message:""})},register:e=>{l(n,{isLoading:!0,isSubmitted:!1,message:""}),t.register(e).subscribe({next:s=>{l(n,{isLoading:!1,isSubmitted:!0,message:s.message})},error:s=>{l(n,{isLoading:!1,isSubmitted:!0,user:null,message:s.message||"User is not authorized"})}})},login:e=>{l(n,{isLoading:!0,isSubmitted:!1,message:""}),t.login(e).subscribe({next:s=>{o.set("token",s.token,1,"/","",!0,"Lax"),l(n,{isLoading:!1,isSubmitted:!0,isLoggedIn:!0,message:s.message})},error:s=>{l(n,{isLoading:!1,isSubmitted:!0,isLoggedIn:!1,message:s.message||"User is not authorized"})}})}})));export{G as a,de as b};
